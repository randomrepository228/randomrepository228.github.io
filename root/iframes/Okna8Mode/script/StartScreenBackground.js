var StartScreenBackgrounds = {
    '20000': ['119,102,178', '24,0,82', '24,0,82', '70,23,180', '0vh'],
    '20200': ['21,99,105', '82,82,82', '82,82,82', '0,154,156', '0vh'],
    '20400': ['95,0,255', '42,11,123', '0,57,129', '0,171,255', '0vh'],
    '20500': ['133,105,91', '189,134,0', '189,134,0', '234,173,0', '0vh'],
    '20600': ['28,135,141', '0,114,117', '0,114,117', '0,209,210', '0vh'],
    '20700': ['230,100,172', '140,0,90', '140,0,90', '249,0,165', '0vh'],
    '21000': ['24,152,0', '0,60,0', '0,60,0', '22,153,0', '0vh'],
    '21100': ['113,60,153', '86,57,138', '86,57,138', '142,86,251', '0vh'],
    '21200': ['119,102,178', '182,94,43', '182,94,43', '255,137,43', '0vh'],
    '21300': ['30,105,180', '85,0,45', '85,0,45', '162,0,105', '0vh'],
    '21400': ['65,195,255', '0,155,240', '0,155,240', '65,195,255', '0vh'],
    '21600': ['44,118,162', '9,26,69', '9,26,69', '0,117,198', '0vh'],
    '21800': ['119,102,178', '24,0,82', '24,0,82', '70,23,180', '0vh'],
    '22000': ['119,102,178', '24,0,82', '24,0,82', '70,23,180', '30vh'],
    '22100': ['251,122,64', '38,0,72', '38,0,72', '104,0,179', 'calc(20vh / 1.75)']
}

$('.StartScreenBackground').append(`
<div class="bg20200">
    <img class="i20200-1 f" src="img/StartScreenImages/20200/20200-1.png" alt="">
    <img class="i20200-2 f" src="img/StartScreenImages/20200/20200-2.png" alt="">
</div>
<div class="bg20400">
    <img class="i20400-1 b"  src="img/StartScreenImages/20400/20400-1.png"  alt="">
    <img class="i20400-2 b"  src="img/StartScreenImages/20400/20400-2.png"  alt="">
    <img class="i20400-3 f"  src="img/StartScreenImages/20400/20400-3.png"  alt="">
    <img class="i20400-4 f"  src="img/StartScreenImages/20400/20400-4.png"  alt="">
    <img class="i20400-5 f"  src="img/StartScreenImages/20400/20400-5.png"  alt="">
    <img class="i20400-6 f"  src="img/StartScreenImages/20400/20400-6.png"  alt="">
    <img class="i20400-7 f"  src="img/StartScreenImages/20400/20400-7.png"  alt="">
    <img class="i20400-8 f"  src="img/StartScreenImages/20400/20400-8.png"  alt="">
    <img class="i20400-9 b"  src="img/StartScreenImages/20400/20400-9.png"  alt="">
    <img class="i20400-10 b" src="img/StartScreenImages/20400/20400-10.png" alt="">
</div>
<div class="bg20500">
    <img class="i20500-5 f" src="img/StartScreenImages/20500/20500-5.png" alt="">
    <img class="i20500-6 f" src="img/StartScreenImages/20500/20500-6.png" alt="">
    <img class="i20500-7 f" src="img/StartScreenImages/20500/20500-7.png" alt="">
    <img class="i20500-8 f" src="img/StartScreenImages/20500/20500-8.png" alt="">
</div>
<div class="bg20600">
    <img class="i20600-5 f" src="img/StartScreenImages/20600/20600-5.png" alt="">
    <img class="i20600-6 f" src="img/StartScreenImages/20600/20600-6.png" alt="">
    <img class="i20600-7 f" src="img/StartScreenImages/20600/20600-7.png" alt="">
    <img class="i20600-8 f" src="img/StartScreenImages/20600/20600-8.png" alt="">
</div>
<div class="bg20700">
    <img class="i20700-1 b" src="img/StartScreenImages/20700/20700-1.png" alt="">
    <img class="i20700-2 b" src="img/StartScreenImages/20700/20700-2.png" alt="">
    <img class="i20700-7 f" src="img/StartScreenImages/20700/20700-7.png" alt="">
    <img class="i20700-8 f" src="img/StartScreenImages/20700/20700-8.png" alt="">
</div>
<div class="bg21000">
    <img class="i21000-10 f" src="img/StartScreenImages/21000/21000-10.png" alt="">
</div>
<div class="bg21100">
    <img class="i21100-1 f" src="img/StartScreenImages/21100/21100-1.png" alt="">
    <img class="i21100-2 f" src="img/StartScreenImages/21100/21100-2.png" alt="">
</div>
<div class="bg21200">
    <img class="i21200-3 f" src="img/StartScreenImages/21200/21200-3.png" alt="">
    <img class="i21200-4 f" src="img/StartScreenImages/21200/21200-4.png" alt="">
</div>
<div class="bg21300">
    <img class="i21300-5 f" src="img/StartScreenImages/21300/21300-5.png" alt="">
</div>
<div class="bg21400">
    <img class="i21400-1 f" src="img/StartScreenImages/21400/21400-1.png" alt="">
    <img class="i21400-2 f" src="img/StartScreenImages/21400/21400-2.png" alt="">
</div>
<div class="bg21600">
    <img class="i21600-1 b" src="img/StartScreenImages/21600/21600-1.png" alt="">
    <img class="i21600-2 f" src="img/StartScreenImages/21600/21600-2.png" alt="">
    <img class="i21600-3 f" src="img/StartScreenImages/21600/21600-3.png" alt="">
    <img class="i21600-6 f" src="img/StartScreenImages/21600/21600-6.png" alt="">
    <img class="i21600-7 f" src="img/StartScreenImages/21600/21600-7.png" alt="">
</div>
<div class="bg21800">
    <img class="i21800-1 f" src="img/StartScreenImages/21800/21800-1.png" alt="">
    <img class="i21800-2 f" src="img/StartScreenImages/21800/21800-2.png" alt="">
    <img class="i21800-3 f" src="img/StartScreenImages/21800/21800-3.png" alt="">
    <img class="i21800-4 f" src="img/StartScreenImages/21800/21800-4.png" alt="">
    <img class="i21800-5 f" src="img/StartScreenImages/21800/21800-5.png" alt="">
    <img class="i21800-6 f" src="img/StartScreenImages/21800/21800-6.png" alt="">
</div>
<div class="bg22000">
    <img class="i22000-2 f" src="img/StartScreenImages/22000/22000-2.png" alt="">
    <img class="i22000-3 f" src="img/StartScreenImages/22000/22000-3.png" alt="">
    <img class="i22000-4 f" src="img/StartScreenImages/22000/22000-4.png" alt="">
    <img class="i22000-1 f" src="img/StartScreenImages/22000/22000-1.png" alt="">
</div>
<div class="bg22100">
    <img class="i22100-2 b" src="img/StartScreenImages/22100/22100-2.png" alt="">
    <img class="i22100-4 b" src="img/StartScreenImages/22100/22100-4.png" alt="">
    <img class="i22100-9 b" src="img/StartScreenImages/22100/22100-9.png" alt="">
    <img class="i22100-8 b" src="img/StartScreenImages/22100/22100-8.png" alt="">
    <img class="i22100-1 b" src="img/StartScreenImages/22100/22100-1.png" alt="">
    <img class="i22100-3 b" src="img/StartScreenImages/22100/22100-3.png" alt="">
    <img class="i22100-5 b" src="img/StartScreenImages/22100/22100-5.png" alt="">
    <img class="i22100-6 f" src="img/StartScreenImages/22100/22100-6.png" alt="">
    <img class="i22100-7 f" src="img/StartScreenImages/22100/22100-7.png" alt="">
    <img class="i22100-15 f" src="img/StartScreenImages/22100/22100-15.png" alt="">
    <img class="i22100-16 f" src="img/StartScreenImages/22100/22100-16.png" alt="">
    <img class="i22100-10 f" src="img/StartScreenImages/22100/22100-10.png" alt="">
    <img class="i22100-11 f" src="img/StartScreenImages/22100/22100-11.png" alt="">
    <img class="i22100-12 f" src="img/StartScreenImages/22100/22100-12.png" alt="">
    <img class="i22100-13 f" src="img/StartScreenImages/22100/22100-13.png" alt="">
</div>
`)

function DisplayBackground() {
    $('.StartScreenBackground').css('display', 'none')
    var ColorForeground = localStorage.getItem('OKNA8_user_' + currentUser + '_color_foreground')
    var ColorBackground = localStorage.getItem('OKNA8_user_' + currentUser + '_color_background')
    var CurrentBackground = localStorage.getItem('OKNA8_user_' + currentUser + '_StartScreenBackground')
    console.log(localStorage.getItem('OKNA8_user_' + currentUser + '_StartScreenBackground'))
    if (CurrentBackground != 'desktop') {
        $('.StartScreenBackground > div').css('display', 'none')
        $('.StartScreenBackground > .bg' + CurrentBackground).css('display', 'inherit')
        var CurrentBackgroundFHSV = rgb2hsv(StartScreenBackgrounds[CurrentBackground][0].split(',')[0], StartScreenBackgrounds[CurrentBackground][0].split(',')[1], StartScreenBackgrounds[CurrentBackground][0].split(',')[2])
        var CurrentBackgroundBHSV = rgb2hsv(StartScreenBackgrounds[CurrentBackground][1].split(',')[0], StartScreenBackgrounds[CurrentBackground][1].split(',')[1], StartScreenBackgrounds[CurrentBackground][1].split(',')[2])
        var CurrentForeColorHSV = rgb2hsv(MetroColorPaletteF[ColorForeground][0].split(',')[0], MetroColorPaletteF[ColorForeground][0].split(',')[1], MetroColorPaletteF[ColorForeground][0].split(',')[2])
        var CurrentBackColorHSV = rgb2hsv(ColorBackground.split(',')[0], ColorBackground.split(',')[1], ColorBackground.split(',')[2])
        $('.StartScreenBackground > .bg' + CurrentBackground + ' img.f').css('filter',
            'hue-rotate(' + (CurrentForeColorHSV['h'] - CurrentBackgroundFHSV['h']) + 'deg) ' +
            'saturate(' + ((CurrentForeColorHSV['s'] / 100) * 2) + ') ' +
            'brightness(' + (1 + (CurrentForeColorHSV['v'] - CurrentBackgroundFHSV['v']) / 100) + ')')
        $('.StartScreenBackground > .bg' + CurrentBackground + ' img.b').css('filter',
            'hue-rotate(' + (CurrentBackColorHSV['h'] - CurrentBackgroundBHSV['h']) + 'deg) ' +
            'saturate(' + ((CurrentBackColorHSV['s'] / 100)) + ') ' +
            'brightness(' + (1 + (CurrentBackColorHSV['v'] - CurrentBackgroundBHSV['v']) / 100) + ')')
        $('.startScreen .tiles, .startScreen .apps').css('background', 'none')
        setTimeout(() => {
            $('.StartScreenBackground').css('display', 'block')
        }, 1)
    } else {
        $('.StartScreenBackground > div').css('display', 'none')
        $('.startScreen').css('background-image', 'url(img/wallpaper/' + localStorage.getItem('OKNA8_user_' + currentUser + '_appearance_wallpaper').split('|')[0] + ')')
        $('.startScreen .tiles, .startScreen .apps').css('background', 'rgba(0,0,0,0.4)')
        setTimeout(() => {
            $('.StartScreenBackground').css('display', 'block')
        }, 1)
    }
}

function SetStartTheme(theme, palleteb, palletef) {
    if (theme != 'desktop') {
        localStorage.setItem('OKNA8_user_' + currentUser + '_StartScreenBackground', theme)
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_foreground', StartScreenBackgrounds[theme][3])
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_background', StartScreenBackgrounds[theme][2])
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_foreground_paletteid', palletef)
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_background_paletteid', palleteb)
        $('#cb_personalize_b_inputrange').val(localStorage.getItem('OKNA8_user_' + currentUser + '_color_background_paletteid'))
        $('#cb_personalize_f_inputrange').val(localStorage.getItem('OKNA8_user_' + currentUser + '_color_foreground_paletteid'))
        $('.personalize-input-b-style').html('#cb_personalize_b_inputrange::-webkit-slider-thumb { background-color:rgb(' + MetroColorPaletteB2[$('#cb_personalize_b_inputrange').val()][0] + ')}')
        $('.personalize-input-f-style').html('#cb_personalize_f_inputrange::-webkit-slider-thumb { background-color:rgb(' + MetroColorPaletteB2[$('#cb_personalize_f_inputrange').val()][0] + ')}')
        ColorPaletteApply()
        DisplayBackground()
        cb_personalize_currentpaletteB = localStorage.getItem('OKNA8_user_' + currentUser + '_color_background_paletteid')
        cb_personalize_currentpaletteF = localStorage.getItem('OKNA8_user_' + currentUser + '_color_foreground_paletteid')
        cb_personalize_paletteselectB(cb_personalize_currentpaletteB)
        cb_personalize_paletteselectF(cb_personalize_currentpaletteF)
    } else {
        localStorage.setItem('OKNA8_user_' + currentUser + '_StartScreenBackground', 'desktop')
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_foreground', '119,119,119')
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_background', '59,59,59')
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_foreground_paletteid', 1)
        localStorage.setItem('OKNA8_user_' + currentUser + '_color_background_paletteid', 1)
        $('#cb_personalize_b_inputrange').val(localStorage.getItem('OKNA8_user_' + currentUser + '_color_background_paletteid'))
        $('#cb_personalize_f_inputrange').val(localStorage.getItem('OKNA8_user_' + currentUser + '_color_foreground_paletteid'))
        $('.personalize-input-b-style').html('#cb_personalize_b_inputrange::-webkit-slider-thumb { background-color:rgb(' + MetroColorPaletteB2[$('#cb_personalize_b_inputrange').val()][0] + ')}')
        $('.personalize-input-f-style').html('#cb_personalize_f_inputrange::-webkit-slider-thumb { background-color:rgb(' + MetroColorPaletteB2[$('#cb_personalize_f_inputrange').val()][0] + ')}')
        ColorPaletteApply()
        DisplayBackground()
        cb_personalize_currentpaletteB = localStorage.getItem('OKNA8_user_' + currentUser + '_color_background_paletteid')
        cb_personalize_currentpaletteF = localStorage.getItem('OKNA8_user_' + currentUser + '_color_foreground_paletteid')
        cb_personalize_paletteselectB(cb_personalize_currentpaletteB)
        cb_personalize_paletteselectF(cb_personalize_currentpaletteF)
    }
}

$('.cb_panel_personalize .theme.desktop > img').attr('src', 'img/wallpaper/' + localStorage.getItem('OKNA8_user_' + currentUser + '_desktopWallpaper') + '.jpg')